#!/usr/bin/env node
/**
 * Possibly Unused i18n Token Finder
 * Key word: POSSIBLY
 *
 * Looks for i18n tokens that MAY be unused by the code
 * Since some tokens are generated dynamically, the list generated by this script
 * should ALWAYS be verified manually before removing any of the tokens in it
 *
 * Ghostery i18n Tools
 * http://www.ghostery.com/
 *
 * Copyright 2019 Ghostery, Inc. All rights reserved.
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0
 */

const readline = require('readline');
const f = require('./funcs.js');

f.check_node_version_and_quit_if_it_is_too_low();
f.print_cli_header();

const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
    prompt: 'Choose an option: '
});

rl.prompt();

rl.on('line', (line) => {
    switch(line.trim()) {
        case 'f':

    }
})

f.verify_tool_folder_exists_and_make_it_if_it_doesnt();
f.verify_config_file_exists_and_make_a_default_one_if_it_doesnt();
// We exit at this point if the config file did not exist
// Otherwise, we keep going:
const config = f.load_config_file();
const tokens = f.load_tokens(config.defaultLocaleTokensFilepath);
const filepaths = f.load_filepaths(config.locationsToLookForTokens);
const unusedTokens = f.find_unused_tokens(tokens, filepaths);
f.save_results(unusedTokens);

// // CLI
// console.log("");
// console.log("*** i18n-tools ***");
// console.log("f Find unused tokens");
// console.log("p Purge unused tokens");
// console.log("");
//
// const readline = require('readline');
//
// const rl = readline.createInterface({
//     input: process.stdin,
//     output: process.stdout,
//     prompt: 'q Quit | h Instructions: '
// });
//
// rl.prompt();
//
// rl.on('line', (line) => {
//     switch (line.trim()) {
//         case 'f':
//             console.log('looking for unused tokens...');
//             findUnusedTokens();
//             break;
//         case '2':
//             console.log('number two!');
//             break;
//         case 'Q':
//         case 'q':
//             rl.close();
//         default:
//             console.log('Please make a valid selection.');
//             break;
//     }
//     rl.prompt();
// }).on('close', () => {
//     console.log('Have a great day!');
//     process.exit(0);
// });

